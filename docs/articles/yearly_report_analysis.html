<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>How Important are Yearly Reports? • StepRegression</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="How Important are Yearly Reports?">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">StepRegression</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/demo.html">Step Regression Demo</a>
    </li>
    <li>
      <a href="../articles/yearly_report_analysis.html">How Important are Yearly Reports?</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>How Important are Yearly Reports?</h1>
            
      
      
      <div class="hidden name"><code>yearly_report_analysis.rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This notebook is concerned with the question of how important the summary statistics contained in yearly reports are on stock prices. More specifically, it is concerned with the question of when those statistics are most important. Is it at the time that the report is released–usually a couple of months after the year-ending period–that these figures have the most explanatory power? Or do the most interested parties figure out these figures well before the report is released, making them most important just after the year-ending period? Yet another possibility would be that interested parties can so effectively anticipate these figures so that their impact is dispersed and no sudden change in price can be attributed to them? Using regression analysis, this notebook seeks to answer which of these models is correct.</p>
<div id="model" class="section level2">
<h2 class="hasAnchor">
<a href="#model" class="anchor"></a>Model</h2>
<p>There is a statistical figure that specifically measures the explanatory power of a particular set of independent variables on a dependent variable: R-Squared. Normally R-Squared is one of several variables used to meausure model effectiveness, but here it serves as a useful measure of how important the figures of a yearly report are. The independent variable we are using is the number of business days before or after the reporting period for a company ends.</p>
</div>
<div id="sub-models" class="section level2">
<h2 class="hasAnchor">
<a href="#sub-models" class="anchor"></a>Sub-Models</h2>
<p>For each day we wish to R-Squared, we need a model. For these models, the dependent variable is the change in stock price compared to five business days earlier, and for independent variables we will use whichever two figures from our data are found to be the most important five business days after the year-ending period.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tidyr)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(rlang)</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(readr)</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(fs)</a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(StepRegression)</a></code></pre></div>
</div>
<div id="our-dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#our-dataset" class="anchor"></a>Our Dataset</h2>
<p>We are making use of a NYSE Dataset available on Kaggle. Despite its name, it includes many stocks from the Nasdaq as well as the NYSE. This is historical data ranging from 2012 to 2016, and covering 501 distinct stocks–though this does include GOOG and GOOGL (Google class C and Google class A shares respectively whose prices differ very little). The dataset consists of four tables, one of which includes daily price data, and another of which has data on each stock for a given year. Unfortunately, quarterly reports are not included, limiting the number of useful cases available.</p>
<p>The variables we are concentrating on for our sub-models will be those that are already normalized for a company’s size. Thus such numbers as the earnings per share, cash ratio, and profit margins. Rather than include the full dataset, which would be over 100MB, we are instead doing most of the cleaning and wrangling in a seperate program before loading it.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">stock_data &lt;-<span class="st"> </span>StepRegression<span class="op">:::</span><span class="kw">load_stock_data</span>()</a></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(stock_data)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 35
##   After_Tax_ROE Cash_Ratio Pre_Tax_Margin Pre_Tax_ROE Profit_Margin Quick_Ratio
##           &lt;dbl&gt;      &lt;dbl&gt;          &lt;dbl&gt;       &lt;dbl&gt;         &lt;dbl&gt;       &lt;dbl&gt;
## 1            23         53             10          31             8          72
## 2            67         75              8          80             7          96
## 3           143         60              8         159             7          80
## 4           135         51             11          82            19          67
## 5            32         23             10          52             6          34
## 6            26         40             10          41             6          52
## # ... with 29 more variables: Earnings_Per_Share &lt;dbl&gt;, symbol &lt;chr&gt;,
## #   date &lt;date&gt;, close &lt;dbl&gt;, minus60_days &lt;dbl&gt;, minus55_days &lt;dbl&gt;,
## #   minus50_days &lt;dbl&gt;, minus45_days &lt;dbl&gt;, minus40_days &lt;dbl&gt;,
## #   minus35_days &lt;dbl&gt;, minus30_days &lt;dbl&gt;, minus25_days &lt;dbl&gt;,
## #   minus20_days &lt;dbl&gt;, minus15_days &lt;dbl&gt;, minus10_days &lt;dbl&gt;,
## #   minus5_days &lt;dbl&gt;, minus0_days &lt;dbl&gt;, plus5_days &lt;dbl&gt;, plus10_days &lt;dbl&gt;,
## #   plus15_days &lt;dbl&gt;, plus20_days &lt;dbl&gt;, plus25_days &lt;dbl&gt;, plus30_days &lt;dbl&gt;,
## #   plus35_days &lt;dbl&gt;, plus40_days &lt;dbl&gt;, plus45_days &lt;dbl&gt;, plus50_days &lt;dbl&gt;,
## #   plus55_days &lt;dbl&gt;, plus60_days &lt;dbl&gt;</code></pre>
</div>
<div id="data-overview" class="section level2">
<h2 class="hasAnchor">
<a href="#data-overview" class="anchor"></a>Data Overview</h2>
<p>Simply looking at some histograms of the data, the dates for period-ending range from late 2012 to early 2017–with most being just before New Years, but many use other dates. The closing price of these companies is somewhat of a pareto distribution–hardly uncommon for price data. Finally, if we look at the 5-business day changes in stock prices (looking at +/- 60 market days each companies year-end), these are normally distributed.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span>( <span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="dt">data =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>) )</a>
<a class="sourceLine" id="cb5-2" title="2">col =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/grDevices/hcl.html">hcl</a></span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">c =</span> <span class="dv">50</span>, <span class="dt">l =</span> <span class="dv">70</span>, <span class="dt">alpha =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb5-3" title="3"><span class="kw"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(stock_data<span class="op">$</span>date, <span class="dt">breaks =</span> <span class="dv">50</span>, <span class="dt">main =</span> <span class="st">'Histogram of Period-Ending Dates'</span>, <span class="dt">xlab =</span> <span class="st">'Period Ending'</span>, <span class="dt">col =</span> col)</a>
<a class="sourceLine" id="cb5-4" title="4">col =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/grDevices/hcl.html">hcl</a></span>(<span class="dt">h =</span> <span class="dv">120</span>, <span class="dt">c =</span> <span class="dv">50</span>, <span class="dt">l =</span> <span class="dv">70</span>, <span class="dt">alpha =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb5-5" title="5"><span class="kw"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(stock_data<span class="op">$</span>close, <span class="dt">breaks =</span> <span class="st">'Scott'</span>, <span class="dt">main =</span> <span class="st">'Histogram of Closing Stock Prices'</span>, <span class="dt">col =</span> col)</a>
<a class="sourceLine" id="cb5-6" title="6">temp =<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">10</span><span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(stock_data) ) temp =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(temp, stock_data[,i] ))</a>
<a class="sourceLine" id="cb5-8" title="8">col =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/grDevices/hcl.html">hcl</a></span>(<span class="dt">h =</span> <span class="dv">240</span>, <span class="dt">c =</span> <span class="dv">50</span>, <span class="dt">l =</span> <span class="dv">70</span>, <span class="dt">alpha =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb5-9" title="9"><span class="kw"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>( temp, <span class="dt">breaks =</span> <span class="st">'Scott'</span>, <span class="dt">xlim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">50</span>,<span class="dv">50</span>) , <span class="dt">main =</span> <span class="st">'Histogram of 5-Day Price Changes'</span>, <span class="dt">col =</span> col)</a></code></pre></div>
<p><img src="yearly_report_analysis_files/figure-html/histograms-1.png" width="768"></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(temp)</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="dt">data =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>)))</a></code></pre></div>
</div>
<div id="data-cleaning" class="section level2">
<h2 class="hasAnchor">
<a href="#data-cleaning" class="anchor"></a>Data Cleaning</h2>
<p>While most of the data becomes clean, but there is one piece that remains to be addressed. The price changes for five-day periods were created using lag and lead functions–but these create NAs at the beginning and end of the dataset where there is no data to shift into the cells. This problem gets worse as the number of cells shifted increase, so that if a column for prices shifted 5 business days has 1 NA value, shifted it 10 days will give 6 NA values, and 60 days will give 56 NA values.</p>
<p>So when looking at our sub-models, there is a question of whether we should maximize the data available at the cost of some models having more data to work with than others (inconsistency), or whether we should prioritize consistency at the cost of dropping more data. Here, we are going with the latter option.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">before &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(stock_data)</a>
<a class="sourceLine" id="cb7-2" title="2">stock_data &lt;-<span class="st"> </span>stock_data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="st">  </span>tidyr<span class="op">::</span><span class="kw"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span>()</a>
<a class="sourceLine" id="cb7-4" title="4"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">'Dropped'</span>, before <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(stock_data), <span class="st">'rows.'</span> ) )</a></code></pre></div>
<pre><code>## [1] "Dropped 497 rows."</code></pre>
</div>
<div id="step-regression-and-variable-selection" class="section level2">
<h2 class="hasAnchor">
<a href="#step-regression-and-variable-selection" class="anchor"></a>Step Regression and Variable Selection</h2>
<p>To choose variables for the sub-models, this notebook uses a stepwise regression to find which figures have the most explanatory power for 5-day price changes. The step_regression function makes a rough estimate of which variables in a design matrix are most sigificant, then regresses them out one-by-one and calculates how the residuals change. We then plot the changing residuals with their Mean-Squared Error and how much each subsequent variable reduces the SSE</p>
<p>Looking at the results, there are two variables that stand out: earnings per share and the pre-tax profit margin. Once these two are included, none of the other variables explains so much as 1% of the the variation. Moreover, these are clearly important variables: the question was simply whether they were more or less important than the post-tax profit margin or the pre/post-tax return on equity. Thus for our sub-models, we will be using these two and no others.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">x &lt;-<span class="st"> </span>stock_data[,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>)]</a>
<a class="sourceLine" id="cb9-2" title="2">x =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(x)</a>
<a class="sourceLine" id="cb9-3" title="3">y &lt;-<span class="st"> </span>stock_data<span class="op">$</span>plus5_days</a>
<a class="sourceLine" id="cb9-4" title="4">y =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span>(y)</a>
<a class="sourceLine" id="cb9-5" title="5">res_matrix &lt;-<span class="st"> </span>StepRegression<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/StepRegression/man/step_regression.html">step_regression</a></span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)</a>
<a class="sourceLine" id="cb9-6" title="6">StepRegression<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/StepRegression/man/res_plotter_double.html">res_plotter_double</a></span>(<span class="dt">res =</span> res_matrix, <span class="dt">y =</span> y, <span class="dt">xlab =</span> <span class="st">'5-Day Price Change'</span>, <span class="dt">main =</span> <span class="st">'Stepwise Regression on Yearly Report Figures to Predict 5-Day Price Change'</span>)</a></code></pre></div>
<p><img src="yearly_report_analysis_files/figure-html/Variable_Selection-1.png" width="768"></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">stock_data &lt;-<span class="st"> </span>stock_data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>( <span class="op">-</span><span class="st"> </span>.data<span class="op">$</span>Profit_Margin, <span class="op">-</span><span class="st"> </span>.data<span class="op">$</span>Quick_Ratio, <span class="op">-</span><span class="st"> </span>.data<span class="op">$</span>Pre_Tax_ROE,</a>
<a class="sourceLine" id="cb10-3" title="3">                 <span class="op">-</span><span class="st"> </span>.data<span class="op">$</span>Cash_Ratio, <span class="op">-</span><span class="st"> </span>.data<span class="op">$</span>After_Tax_ROE)</a>
<a class="sourceLine" id="cb10-4" title="4"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(stock_data)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 30
##   Pre_Tax_Margin Earnings_Per_Sh~ symbol date       close minus60_days
##            &lt;dbl&gt;            &lt;dbl&gt; &lt;chr&gt;  &lt;date&gt;     &lt;dbl&gt;        &lt;dbl&gt;
## 1             10            -5.6  AAL    2012-12-31  13.5        0.6  
## 2              8           -11.2  AAL    2013-12-31  25.2        1.45 
## 3              8             4.02 AAL    2014-12-31  53.6       -0.100
## 4             11            11.4  AAL    2015-12-31  42.3       -1.05 
## 5             10             5.29 AAP    2012-12-28  71.5        0.150
## 6             10             5.36 AAP    2013-12-27 110.         1.16 
## # ... with 24 more variables: minus55_days &lt;dbl&gt;, minus50_days &lt;dbl&gt;,
## #   minus45_days &lt;dbl&gt;, minus40_days &lt;dbl&gt;, minus35_days &lt;dbl&gt;,
## #   minus30_days &lt;dbl&gt;, minus25_days &lt;dbl&gt;, minus20_days &lt;dbl&gt;,
## #   minus15_days &lt;dbl&gt;, minus10_days &lt;dbl&gt;, minus5_days &lt;dbl&gt;,
## #   minus0_days &lt;dbl&gt;, plus5_days &lt;dbl&gt;, plus10_days &lt;dbl&gt;, plus15_days &lt;dbl&gt;,
## #   plus20_days &lt;dbl&gt;, plus25_days &lt;dbl&gt;, plus30_days &lt;dbl&gt;, plus35_days &lt;dbl&gt;,
## #   plus40_days &lt;dbl&gt;, plus45_days &lt;dbl&gt;, plus50_days &lt;dbl&gt;, plus55_days &lt;dbl&gt;,
## #   plus60_days &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">r_squared_values &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb12-2" title="2">day_shift &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dt">from =</span> <span class="dv">-60</span>, <span class="dt">to =</span> <span class="dv">60</span>, <span class="dt">by =</span> <span class="dv">5</span>) )</a>
<a class="sourceLine" id="cb12-3" title="3"></a>
<a class="sourceLine" id="cb12-4" title="4">x &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(stock_data[,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'Pre_Tax_Margin'</span>,<span class="st">'Earnings_Per_Share'</span>)])</a>
<a class="sourceLine" id="cb12-5" title="5"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">6</span><span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(stock_data) ){</a>
<a class="sourceLine" id="cb12-6" title="6">  y &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(stock_data[,i]))</a>
<a class="sourceLine" id="cb12-7" title="7">  denominator &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>( (y <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(y) )<span class="op">^</span><span class="dv">2</span> )</a>
<a class="sourceLine" id="cb12-8" title="8">  r_squared_values &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(r_squared_values, <span class="dv">1</span><span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>( (y <span class="op">-</span><span class="st"> </span>x <span class="op">%*%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/solve.html">solve</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(x) <span class="op">%*%</span><span class="st"> </span>x) <span class="op">%*%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(x) <span class="op">%*%</span><span class="st"> </span>y)<span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>denominator) }</a>
<a class="sourceLine" id="cb12-9" title="9">model_res =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(day_shift, r_squared_values)</a>
<a class="sourceLine" id="cb12-10" title="10"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(model_res)</a></code></pre></div>
<pre><code>##      day_shift r_squared_values
## [1,]       -60       0.02290056
## [2,]       -55       0.01015725
## [3,]       -50       0.04361948
## [4,]       -45       0.03225700
## [5,]       -40       0.07076405
## [6,]       -35       0.02648990</code></pre>
</div>
<div id="r-squared-over-time" class="section level2">
<h2 class="hasAnchor">
<a href="#r-squared-over-time" class="anchor"></a>R-Squared Over Time</h2>
<p>Using earnings per share and the pre-tax profit margin, I constructed a series of models using the same independent variables, earnings per share and pre-tax profit margin, but each attempting to predict a change in price over a different 5-business day period. These in turn give us the real variable we are interested in: the R-Squared–in other words, how well two key variables from a yearly report measure the change over a five-day period. Peaks should indicate when these figures were most important to the market.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(model_res, <span class="dt">type =</span> <span class="st">'l'</span>, <span class="dt">col =</span> <span class="st">'purple'</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">main =</span> <span class="st">'Performance of Different Models'</span>, <span class="dt">xlab =</span> <span class="st">'Days Before and Ahead'</span>, <span class="dt">ylab =</span> <span class="st">'R-Squared Values'</span>)</a>
<a class="sourceLine" id="cb14-2" title="2"><span class="kw"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="dt">v =</span> <span class="dv">0</span>, <span class="dt">col =</span> <span class="st">'red'</span>)</a>
<a class="sourceLine" id="cb14-3" title="3"><span class="kw"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="dt">v =</span> <span class="dv">-40</span>, <span class="dt">col =</span> <span class="st">'blue'</span>)</a>
<a class="sourceLine" id="cb14-4" title="4"><span class="kw"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="dt">v =</span> <span class="dv">5</span>, <span class="dt">col =</span> <span class="st">'blue'</span>)</a>
<a class="sourceLine" id="cb14-5" title="5"><span class="kw"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="dt">v =</span> <span class="dv">30</span>, <span class="dt">col =</span> <span class="st">'blue'</span>)</a></code></pre></div>
<p><img src="yearly_report_analysis_files/figure-html/Plot_R2-1.png" width="700"></p>
</div>
<div id="conclusion" class="section level2">
<h2 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h2>
<p>Looking at the plot, we see the R-Squared values have three peaks: one at -40-business days, another at 5-business days, and the highest at 30-business days. The first two peaks are relatively low, but assuming they were significant, then the -40-day peak is likely the result of numbers in the 3rd-quarter reports that are anticipatory of the yearly report, while the 5-day peak could be a result of early estimates of the numbers in the yearly report.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#introduction">Introduction</a><ul class="nav nav-pills nav-stacked">
<li><a href="#model">Model</a></li>
      <li><a href="#sub-models">Sub-Models</a></li>
      <li><a href="#our-dataset">Our Dataset</a></li>
      <li><a href="#data-overview">Data Overview</a></li>
      <li><a href="#data-cleaning">Data Cleaning</a></li>
      <li><a href="#step-regression-and-variable-selection">Step Regression and Variable Selection</a></li>
      <li><a href="#r-squared-over-time">R-Squared Over Time</a></li>
      <li><a href="#conclusion">Conclusion</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Chris Pearson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
